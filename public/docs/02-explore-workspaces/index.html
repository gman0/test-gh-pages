<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Explore workspaces
  #

Workspaces are one of kcp&rsquo;s core concepts, and in this exercise we&rsquo;ll explore what they are and how to work with them.
See Workspaces documentation at docs.kcp.io/kcp/main/concepts/workspaces/.

  Pre-requisites, take two
  #

Workspaces, or kcp for that matter, is not something that vanilla kubectl knows about. kcp brings support for those using krew plugins. You may remember, we installed kubect-krew in the very first warm-up exercise. Now we need to install the plugins themselves:">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost/docs/02-explore-workspaces/">
  <meta property="og:site_name" content="kcp @ Kubecon 2025 London">
  <meta property="og:title" content="02: Exploring workspaces">
  <meta property="og:description" content="Explore workspaces # Workspaces are one of kcpâ€™s core concepts, and in this exercise weâ€™ll explore what they are and how to work with them.
See Workspaces documentation at docs.kcp.io/kcp/main/concepts/workspaces/.
Pre-requisites, take two # Workspaces, or kcp for that matter, is not something that vanilla kubectl knows about. kcp brings support for those using krew plugins. You may remember, we installed kubect-krew in the very first warm-up exercise. Now we need to install the plugins themselves:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>02: Exploring workspaces | kcp @ Kubecon 2025 London</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost/docs/02-explore-workspaces/">
<link rel="stylesheet" href="/book.min.434035e7885c7f5d12818bd9f111cf1a0925c6fb78382667381c3d5eda3fb4f1.css" integrity="sha256-Q0A154hcf10SgYvZ8RHPGgklxvt4OCZnOBw9Xto/tPE=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.4bff042756c61d32436b7c73a5e66109836e4c4410210cb96ce108d550ad27b5.js" integrity="sha256-S/8EJ1bGHTJDa3xzpeZhCYNuTEQQIQy5bOEI1VCtJ7U=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.svg" alt="Logo" class="book-icon" /><span>kcp @ Kubecon 2025 London</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/00-prerequisites/" class="">00: Setting up your development environment</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/01-deploy-kcp/" class="">01: Deploying kcp</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/02-explore-workspaces/" class="active">02: Exploring workspaces</a>
  

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>02: Exploring workspaces</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#pre-requisites-take-two">Pre-requisites, take two</a></li>
    <li><a href="#sprawling-workspaces">Sprawling workspaces</a></li>
    <li><a href="#exporting-and-binding-apis-across-workspaces">Exporting and binding APIs across workspaces</a>
      <ul>
        <li><a href="#service-provider">Service provider</a></li>
        <li><a href="#service-consumer">Service consumer</a></li>
        <li><a href="#spec-up-status-down">Spec up, status down</a></li>
      </ul>
    </li>
    <li><a href="#high-five-">High-five! ðŸš€ðŸš€ðŸš€</a>
      <ul>
        <li><a href="#cheat-sheet">Cheat-sheet</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="explore-workspaces">
  Explore workspaces
  <a class="anchor" href="#explore-workspaces">#</a>
</h1>
<p>Workspaces are one of kcp&rsquo;s core concepts, and in this exercise we&rsquo;ll explore what they are and how to work with them.</p>
<p>See Workspaces documentation at <a href="https://docs.kcp.io/kcp/main/concepts/workspaces/">docs.kcp.io/kcp/main/concepts/workspaces/</a>.</p>
<h2 id="pre-requisites-take-two">
  Pre-requisites, take two
  <a class="anchor" href="#pre-requisites-take-two">#</a>
</h2>
<p>Workspaces, or kcp for that matter, is not something that vanilla kubectl knows about. kcp brings support for those using <a href="https://krew.sigs.k8s.io/">krew</a> plugins. You may remember, we installed kubect-krew in the very first warm-up exercise. Now we need to install the plugins themselves:</p>
<div class="book-tabs">
<input type="radio" class="toggle" name="tabs-0" id="tabs-0-0" checked="checked" />
<label for="tabs-0-0">Bash/ZSH</label>
<div class="book-tabs-content markdown-inner">
<blockquote class="book-hint warning">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">WORKSHOP_ROOT</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="color:#289;font-weight:bold">$(</span>git rev-parse --show-toplevel<span style="color:#289;font-weight:bold">)</span><span style="background-color:#e0e0ff">/20250401-kubecon-london/workshop-&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">KREW_ROOT</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="background-color:#eee">${</span><span style="color:#036">workshop_root</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin/.krew&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">PATH</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="background-color:#eee">${</span><span style="color:#036">WORKSHOP_ROOT</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin/.krew/bin:</span><span style="background-color:#eee">${</span><span style="color:#036">WORKSHOP_ROOT</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin:</span><span style="background-color:#eee">${</span><span style="color:#036">PATH</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">&#34;</span>
</span></span></code></pre></div>
</blockquote>
</div>
<input type="radio" class="toggle" name="tabs-0" id="tabs-0-1"  />
<label for="tabs-0-1">Fish</label>
<div class="book-tabs-content markdown-inner">
<blockquote class="book-hint warning">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fish" data-lang="fish"><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">WORKSHOP_ROOT</span> <span style="color:#333">(</span><span style="color:#5ed;font-weight:bold">git</span> rev-parse <span style="color:#007">--show-toplevel</span><span style="color:#333">)</span>/<span style="color:#60e;font-weight:bold">20250401</span>-kubecon-london/workshop-
</span></span><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">KREW_ROOT</span> <span style="color:#036">$WORKSHOP_ROOT</span>/bin/.krew
</span></span><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">PATH</span> <span style="color:#036">$WORKSHOP_ROOT</span>/bin/.krew/bin <span style="color:#036">$WORKSHOP_ROOT</span>/bin <span style="color:#036">$PATH</span><span style="background-color:#e0e0ff">&#34;
</span></span></span></code></pre></div>
</blockquote>
</div>
</div>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl krew index add kcp-dev https://github.com/kcp-dev/krew-index.git
</span></span><span style="display:flex;"><span>kubectl krew install kcp-dev/kcp
</span></span><span style="display:flex;"><span>kubectl krew install kcp-dev/ws
</span></span><span style="display:flex;"><span>kubectl krew install kcp-dev/create-workspace
</span></span></code></pre></div><p>Now you should be able to run and inspect these commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl create workspace --help
</span></span><span style="display:flex;"><span><span style="color:#888">Creates a new workspace
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#f00;background-color:#faa">
</span></span></span><span style="display:flex;"><span><span style="color:#f00;background-color:#faa"></span><span style="color:#888">Usage:
</span></span></span><span style="display:flex;"><span><span style="color:#888">  create [flags]
</span></span></span><span style="display:flex;"><span><span style="color:#888">...
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#f00;background-color:#faa">
</span></span></span><span style="display:flex;"><span><span style="color:#f00;background-color:#faa"></span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws --help
</span></span><span style="display:flex;"><span><span style="color:#888">Manages KCP workspaces
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#f00;background-color:#faa">
</span></span></span><span style="display:flex;"><span><span style="color:#f00;background-color:#faa"></span><span style="color:#888">Usage:
</span></span></span><span style="display:flex;"><span><span style="color:#888">  workspace [create|create-context|use|current|&lt;workspace&gt;|..|.|-|~|&lt;root:absolute:workspace&gt;] [flags]
</span></span></span><span style="display:flex;"><span><span style="color:#888">  workspace [command]
</span></span></span><span style="display:flex;"><span><span style="color:#888">...
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#f00;background-color:#faa">
</span></span></span><span style="display:flex;"><span><span style="color:#f00;background-color:#faa"></span><span style="color:#c65d09;font-weight:bold">$</span> kubectl kcp --help
</span></span><span style="display:flex;"><span><span style="color:#888">...
</span></span></span></code></pre></div><p>With that, let&rsquo;s create some workspaces!</p>
<h2 id="sprawling-workspaces">
  Sprawling workspaces
  <a class="anchor" href="#sprawling-workspaces">#</a>
</h2>
<div class="book-tabs">
<input type="radio" class="toggle" name="tabs-1" id="tabs-1-0" checked="checked" />
<label for="tabs-1-0">Bash/ZSH</label>
<div class="book-tabs-content markdown-inner">
<blockquote class="book-hint warning">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">WORKSHOP_ROOT</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="color:#289;font-weight:bold">$(</span>git rev-parse --show-toplevel<span style="color:#289;font-weight:bold">)</span><span style="background-color:#e0e0ff">/20250401-kubecon-london/workshop-&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">KREW_ROOT</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="background-color:#eee">${</span><span style="color:#036">WORKSHOP_ROOT</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin/.krew&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#072">export</span> <span style="color:#036">PATH</span><span style="color:#333">=</span><span style="background-color:#e0e0ff">&#34;</span><span style="background-color:#eee">${</span><span style="color:#036">workshop_root</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin/.krew/bin:</span><span style="background-color:#eee">${</span><span style="color:#036">workshop_root</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">/bin:</span><span style="background-color:#eee">${</span><span style="color:#036">PATH</span><span style="background-color:#eee">}</span><span style="background-color:#e0e0ff">&#34;</span>
</span></span></code></pre></div>
</blockquote>
</div>
<input type="radio" class="toggle" name="tabs-1" id="tabs-1-1"  />
<label for="tabs-1-1">Fish</label>
<div class="book-tabs-content markdown-inner">
<blockquote class="book-hint warning">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fish" data-lang="fish"><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">WORKSHOP_ROOT</span> <span style="color:#333">(</span><span style="color:#5ed;font-weight:bold">git</span> rev-parse <span style="color:#007">--show-toplevel</span><span style="color:#333">)</span>/<span style="color:#60e;font-weight:bold">20250401</span>-kubecon-london/workshop-
</span></span><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">KREW_ROOT</span> <span style="color:#036">$WORKSHOP_ROOT</span>/bin/.krew
</span></span><span style="display:flex;"><span><span style="color:#289;font-weight:bold">set</span> <span style="color:#007">-gx</span> <span style="color:#036">PATH</span> <span style="color:#036">$WORKSHOP_ROOT</span>/bin/.krew/bin <span style="color:#036">$WORKSHOP_ROOT</span>/bin <span style="color:#036">$PATH</span><span style="background-color:#e0e0ff">&#34;
</span></span></span></code></pre></div>
</blockquote>
</div>
</div>
<p>We&rsquo;ll be using <code>kubectl create workspace</code> command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl create workspace one
</span></span><span style="display:flex;"><span>kubectl create workspace two
</span></span><span style="display:flex;"><span>kubectl create workspace three --enter
</span></span><span style="display:flex;"><span>kubectl create workspace potato
</span></span></code></pre></div><p>Now, let&rsquo;s list what we&rsquo;ve created:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use :
</span></span><span style="display:flex;"><span>kubectl get ws
</span></span></code></pre></div><p>These are the workspaces we created, and they represent logical separation of resources in the cluster.</p>
<p>We haven&rsquo;t seen <code>ws use</code> yet. Using this command, you move into a different workspace in the tree of workspaces, much like <code>cd</code> moves you into a different directory described by a path. In case of workspaces, a path too may be relative or absolute, where <code>:</code> is the path separator, and <code>:</code> alone denotes the root of the tree.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use :
</span></span><span style="display:flex;"><span>kubectl ws use one
</span></span><span style="display:flex;"><span>kubectl get configmap
</span></span><span style="display:flex;"><span>kubectl create configmap <span style="color:#072">test</span> --from-literal<span style="color:#333">=</span><span style="color:#036">test</span><span style="color:#333">=</span>one
</span></span><span style="display:flex;"><span>kubectl get configmap <span style="color:#072">test</span> -o json
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use root:two
</span></span><span style="display:flex;"><span>kubectl get configmap
</span></span><span style="display:flex;"><span>kubectl create configmap <span style="color:#072">test</span> --from-literal<span style="color:#333">=</span><span style="color:#036">test</span><span style="color:#333">=</span>two
</span></span><span style="display:flex;"><span>kubectl get configmap <span style="color:#072">test</span> -o json
</span></span></code></pre></div><p>Notice how even though these two ConfigMaps have the same name <code>test</code>, and are in the same namespace <code>default</code>, they are actually two distinct objects. They live in two different workspaces, and are completely separate.</p>
<p>We&rsquo;ve created a few workspaces now, and already it&rsquo;s easy to lose sight of what is where. Say hello to <code>ws tree</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use :
</span></span><span style="display:flex;"><span>kubectl ws tree
</span></span></code></pre></div><p>You should get output similar to this:</p>
<pre tabindex="0"><code>.
â””â”€â”€ root
    â”œâ”€â”€ one
    â”œâ”€â”€ three
    â”‚   â””â”€â”€ potato
    â””â”€â”€ two
</code></pre><h2 id="exporting-and-binding-apis-across-workspaces">
  Exporting and binding APIs across workspaces
  <a class="anchor" href="#exporting-and-binding-apis-across-workspaces">#</a>
</h2>
<p>Isolation is nice, but what if you need to <em>share?</em></p>
<p>See <a href="https://docs.kcp.io/kcp/main/concepts/apis/exporting-apis/">docs.kcp.io/kcp/main/concepts/apis/exporting-apis/</a> for detailed documentation.</p>
<p>As you&rsquo;ll see next, <em>sharing</em> in this context will be a very well-defined and constrained relationship of provisioning and consuming. We shall model that relationship using workspaces.</p>
<h3 id="service-provider">
  Service provider
  <a class="anchor" href="#service-provider">#</a>
</h3>
<p>Create <code>providers</code> and <code>providers:cowboys</code> workspaces:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use :
</span></span><span style="display:flex;"><span>kubectl ws create providers --enter
</span></span><span style="display:flex;"><span>kubectl ws create cowboys --enter
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws use :
</span></span><span style="display:flex;"><span><span style="color:#888">Current workspace is &#39;root&#39;.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws tree
</span></span><span style="display:flex;"><span><span style="color:#888">.
</span></span></span><span style="display:flex;"><span><span style="color:#888">â””â”€â”€ root
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ one
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ providers
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â””â”€â”€ cowboys
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ three
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â””â”€â”€ potato
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â””â”€â”€ two
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#f00;background-color:#faa">
</span></span></span><span style="display:flex;"><span><span style="color:#f00;background-color:#faa"></span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws use :root:providers:cowboys
</span></span><span style="display:flex;"><span><span style="color:#888">Current workspace is &#39;root:providers:cowboys&#39; (type root:universal).
</span></span></span></code></pre></div><p>Now that we&rsquo;re in <code>:root:providers:cowboys</code>, let&rsquo;s create an <code>APIResourceSchema</code> and an <code>APIExport</code>. We&rsquo;ll discuss what are they for next.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl create -f <span style="color:#036">$WORKSHOP_ROOT</span>/02-explore-workspaces/apis/apiresourceschema.yaml
</span></span><span style="display:flex;"><span>kubectl create -f <span style="color:#036">$WORKSHOP_ROOT</span>/02-explore-workspaces/apis/apiexport.yaml
</span></span></code></pre></div><p>Starting with the first one, <code>APIResourceSchema</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get apiresourceschema -o json
</span></span></code></pre></div><p>Try to skim through the YAML output and you&rsquo;ll notice that it is almost identical to a definition of a CRD. Unlinke a CRD however, <code>APIResourceSchema</code> instance does not have a backing API server, and instead it simply describes an API that we can pass around and refer to. By decoupling the schema definition from serving, API owners can be more explicit about API evolution.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl get apiexport cowboys -o yaml
</span></span></code></pre></div><p>Take a note of the following properties in the output:</p>
<ul>
<li><code>.spec.latestResourceSchemas</code>: refers to specific versions of <code>APIResourceSchema</code> objects,</li>
<li><code>.spec.permissionClaims</code>: describes resource permissions that our API depends on. These are the permissions that we, the service provider, want the consumer to grant us,</li>
<li><code>.status.virtualWorkspaces[].url</code>: the URL where the provider can access the granted resources.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#666;font-style:italic"># Stripped down example output of `kubectl get apiexport` command above.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#070">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#070">latestResourceSchemas</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- today.cowboys.wildwest.dev<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#070">permissionClaims</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#070">all</span>:<span style="color:#bbb"> </span><span style="color:#289;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#070">group</span>:<span style="color:#bbb"> </span><span style="background-color:#e0e0ff">&#34;&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#070">resource</span>:<span style="color:#bbb"> </span>configmaps<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#070">status</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#070">virtualWorkspaces</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#070">url</span>:<span style="color:#bbb"> </span>https://192.168.32.7:6443/services/apiexport/1ctnpog1ny8bnud6/cowboys<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="service-consumer">
  Service consumer
  <a class="anchor" href="#service-consumer">#</a>
</h3>
<p>With the provider in place, let&rsquo;s create two consumers their own workspaces, starting with &ldquo;wild-west&rdquo;:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use :
</span></span><span style="display:flex;"><span>kubectl create workspace consumers --enter
</span></span><span style="display:flex;"><span>kubectl create workspace wild-west --enter
</span></span><span style="display:flex;"><span>kubectl kcp <span style="color:#072">bind</span> apiexport root:providers:cowboys:cowboys --name cowboys-consumer
</span></span><span style="display:flex;"><span>kubectl create -f <span style="color:#036">$WORKSHOP_ROOT</span>/02-explore-workspaces/apis/consumer-wild-west.yaml
</span></span></code></pre></div><p>Let&rsquo;s check the Cowboy we have created:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl get cowboy buckaroo-bill -o json
</span></span><span style="display:flex;"><span><span style="color:#888">{
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;apiVersion&#34;: &#34;wildwest.dev/v1alpha1&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;kind&#34;: &#34;Cowboy&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;metadata&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;annotations&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">            &#34;kcp.io/cluster&#34;: &#34;2snrfbp1a3gww1hu&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">        },
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;creationTimestamp&#34;: &#34;2025-03-12T09:06:53Z&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;generation&#34;: 1,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;name&#34;: &#34;buckaroo-bill&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;namespace&#34;: &#34;default&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;resourceVersion&#34;: &#34;3164&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;uid&#34;: &#34;bb6ece46-84bc-4673-a926-f38c486799cf&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">    },
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;spec&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;intent&#34;: &#34;Ride and protect the wild west!!!&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">    }
</span></span></span><span style="display:flex;"><span><span style="color:#888">}
</span></span></span></code></pre></div><p>And the second consumer, &ldquo;wild-north&rdquo;:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws use ..
</span></span><span style="display:flex;"><span>kubectl create workspace wild-north --enter
</span></span><span style="display:flex;"><span>kubectl kcp <span style="color:#072">bind</span> apiexport root:providers:cowboys:cowboys --name cowboys-consumer
</span></span><span style="display:flex;"><span>kubectl create -f <span style="color:#036">$WORKSHOP_ROOT</span>/02-explore-workspaces/apis/consumer-wild-north.yaml
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl get cowboy hold-the-wall -o json
</span></span><span style="display:flex;"><span><span style="color:#888">{
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;apiVersion&#34;: &#34;wildwest.dev/v1alpha1&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;kind&#34;: &#34;Cowboy&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;metadata&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;annotations&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">            &#34;kcp.io/cluster&#34;: &#34;30j93qa92345q3tp&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">        },
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;creationTimestamp&#34;: &#34;2025-03-12T09:09:32Z&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;generation&#34;: 1,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;name&#34;: &#34;hold-the-wall&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;namespace&#34;: &#34;default&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;resourceVersion&#34;: &#34;3227&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;uid&#34;: &#34;ff96ab88-b738-4af7-8cc0-3872c424d9df&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">    },
</span></span></span><span style="display:flex;"><span><span style="color:#888">    &#34;spec&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#888">        &#34;intent&#34;: &#34;North is there the wall is!&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#888">    }
</span></span></span><span style="display:flex;"><span><span style="color:#888">}
</span></span></span></code></pre></div><p>Great! We have created two instances of a common API, and were able to create a couple of dummy objects with it.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws use :
</span></span><span style="display:flex;"><span><span style="color:#888">Current workspace is &#39;root&#39;.
</span></span></span><span style="display:flex;"><span><span style="color:#888"></span><span style="color:#c65d09;font-weight:bold">$</span> kubectl ws tree
</span></span><span style="display:flex;"><span><span style="color:#888">.
</span></span></span><span style="display:flex;"><span><span style="color:#888">â””â”€â”€ root
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ consumers
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â”œâ”€â”€ wild-north
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â””â”€â”€ wild-west
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ one
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ providers
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â””â”€â”€ cowboys
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”œâ”€â”€ three
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â”‚   â””â”€â”€ potato
</span></span></span><span style="display:flex;"><span><span style="color:#888">    â””â”€â”€ two
</span></span></span></code></pre></div><h3 id="spec-up-status-down">
  Spec up, status down
  <a class="anchor" href="#spec-up-status-down">#</a>
</h3>
<p>We have been moving across namespaces up and down, changing our implied roles. Let&rsquo;s become the service provider again, and see what we can make out from our <code>cowboys</code> APIExport.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl ws :root:providers:cowboys
</span></span><span style="display:flex;"><span>kubectl get apiexport cowboys -o json | jq <span style="background-color:#e0e0ff">&#39;.status.virtualWorkspaces[].url&#39;</span>
</span></span></code></pre></div><p>Using that URL, we can confirm that only the resources we have agreed on are available to the workspaces.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl -s <span style="background-color:#e0e0ff">&#39;https://192.168.32.7:6443/services/apiexport/1ctnpog1ny8bnud6/cowboys/clusters/*&#39;</span> api-resources
</span></span><span style="display:flex;"><span><span style="color:#888">NAME          SHORTNAMES   APIVERSION              NAMESPACED   KIND
</span></span></span><span style="display:flex;"><span><span style="color:#888">configmaps                 v1                      true         ConfigMap
</span></span></span><span style="display:flex;"><span><span style="color:#888">apibindings                apis.kcp.io/v1alpha1    false        APIBinding
</span></span></span><span style="display:flex;"><span><span style="color:#888">cowboys                    wildwest.dev/v1alpha1   true         Cowboy
</span></span></span></code></pre></div><p>We can also list all consumers (i.e. workspaces that have relevant <code>APIBinding</code>) for cowboys <code>APIExport</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell-session" data-lang="shell-session"><span style="display:flex;"><span><span style="color:#c65d09;font-weight:bold">$</span> kubectl -s <span style="background-color:#e0e0ff">&#39;https://192.168.32.7:6443/services/apiexport/1ctnpog1ny8bnud6/cowboys/clusters/*&#39;</span> get cowboys -A
</span></span><span style="display:flex;"><span><span style="color:#888">NAMESPACE   NAME
</span></span></span><span style="display:flex;"><span><span style="color:#888">default     buckaroo-bill
</span></span></span><span style="display:flex;"><span><span style="color:#888">default     hold-the-wall
</span></span></span></code></pre></div><p>You can play around with inspecting the json output of those commands, and try addressing a specific cluster instead of all of them (wildcard <code>*</code>) to get some intuition about how they are wired together.</p>
<p>From that, you can already start imagining what a workspace-aware controller operating on these objects would look like: being able to observe global state in its workspace subtree, it would watch spec updates from its children (Spec up), and push them state updates (State down). Our basic example is lacking such a controller. But that&rsquo;s something we are going to fix the next exercise, on a more interesting example!</p>
<hr>
<h2 id="high-five-">
  High-five! ðŸš€ðŸš€ðŸš€
  <a class="anchor" href="#high-five-">#</a>
</h2>
<p>Finished? High-five! Check-in your completion with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>../02-explore-workspaces/99-highfive.sh
</span></span></code></pre></div><p>If there were no errors, you may continue with the next exercise.</p>
<h3 id="cheat-sheet">
  Cheat-sheet
  <a class="anchor" href="#cheat-sheet">#</a>
</h3>
<p>You may fast-forward through this exercise by running:</p>
<ul>
<li><code>02-explore-workspaces/00-install-krew-plugins.sh</code></li>
<li><code>02-explore-workspaces/01-create-apis.sh</code></li>
<li><code>02-explore-workspaces/02-create-consumers.sh</code></li>
<li><code>02-explore-workspaces/99-highfive.sh</code></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#pre-requisites-take-two">Pre-requisites, take two</a></li>
    <li><a href="#sprawling-workspaces">Sprawling workspaces</a></li>
    <li><a href="#exporting-and-binding-apis-across-workspaces">Exporting and binding APIs across workspaces</a>
      <ul>
        <li><a href="#service-provider">Service provider</a></li>
        <li><a href="#service-consumer">Service consumer</a></li>
        <li><a href="#spec-up-status-down">Spec up, status down</a></li>
      </ul>
    </li>
    <li><a href="#high-five-">High-five! ðŸš€ðŸš€ðŸš€</a>
      <ul>
        <li><a href="#cheat-sheet">Cheat-sheet</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












